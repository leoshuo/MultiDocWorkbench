# Document Workspace 1.6.5 å°ç™½å¼éƒ¨ç½²æŒ‡å—

> ç‰ˆæœ¬: 1.6.5  
> æ›´æ–°æ—¥æœŸ: 2026-01-24  
> é€‚ç”¨å¯¹è±¡: é›¶åŸºç¡€ç”¨æˆ·

---

## ğŸ“¦ ç¦»çº¿éƒ¨ç½²åŒ…å†…å®¹

```
document-workspace-1.6.5-offline.zip (çº¦ 68MB)
â”œâ”€â”€ document-workspace-1.6.5.tar   # Docker é•œåƒï¼ˆé¢„æ„å»ºï¼Œçº¦ 65MBï¼‰
â”œâ”€â”€ data/                          # é…ç½®æ•°æ®ã€æ²‰æ·€è®°å½•
â”œâ”€â”€ docs/                          # å®Œæ•´æ–‡æ¡£
â”œâ”€â”€ test/                          # æµ‹è¯•æ–‡æ¡£
â”œâ”€â”€ dist/                          # å‰ç«¯é™æ€æ–‡ä»¶
â”œâ”€â”€ src/                           # å‰ç«¯æºç 
â”œâ”€â”€ scripts/                       # å®‰è£…è„šæœ¬
â”œâ”€â”€ server.js                      # ä¸»æœåŠ¡
â”œâ”€â”€ docker-compose.yml             # Docker ç¼–æ’é…ç½®
â”œâ”€â”€ Dockerfile                     # Docker æ„å»ºæ–‡ä»¶
â”œâ”€â”€ package.json                   # ä¾èµ–é…ç½®
â””â”€â”€ ...                            # å…¶ä»–é…ç½®æ–‡ä»¶
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### ç¬¬1æ­¥ï¼šä¼ è¾“æ–‡ä»¶åˆ° Linux æœåŠ¡å™¨

**æ–¹æ³•Aï¼šU ç›˜ä¼ è¾“**
```bash
# 1. æŠŠ document-workspace-1.6.5-offline.zip å¤åˆ¶åˆ° U ç›˜
# 2. åœ¨ Linux æœåŠ¡å™¨ä¸ŠæŒ‚è½½ U ç›˜
sudo mount /dev/sdb1 /mnt

# 3. å¤åˆ¶åˆ°ç”¨æˆ·ç›®å½•
cp /mnt/document-workspace-1.6.5-offline.zip ~/

# 4. å¸è½½ U ç›˜
sudo umount /mnt
```

**æ–¹æ³•Bï¼šWinSCP ä¼ è¾“ï¼ˆéœ€ä¸´æ—¶ç½‘ç»œï¼‰**
1. ä¸‹è½½å®‰è£… WinSCPï¼šhttps://winscp.net/
2. è¿æ¥åˆ° Linux æœåŠ¡å™¨ï¼ˆè¾“å…¥ IPã€ç”¨æˆ·åã€å¯†ç ï¼‰
3. æŠŠ zip æ–‡ä»¶æ‹–åˆ° `/home/ä½ çš„ç”¨æˆ·å/` ç›®å½•

---

### ç¬¬2æ­¥ï¼šè§£å‹æ–‡ä»¶

```bash
# è¿›å…¥ç”¨æˆ·ç›®å½•
cd ~

# è§£å‹æ–‡ä»¶
unzip document-workspace-1.6.5-offline.zip

# è¿›å…¥è§£å‹åçš„ç›®å½•
cd document-workspace-1.6.5-offline
```

> ğŸ’¡ å¦‚æœæç¤º `unzip: command not found`ï¼š
> - CentOS: `sudo yum install unzip`
> - Ubuntu: `sudo apt install unzip`

---

### ç¬¬3æ­¥ï¼šé€‰æ‹©éƒ¨ç½²æ–¹å¼

#### ğŸ³ æ–¹å¼ä¸€ï¼šDocker éƒ¨ç½²ï¼ˆæ¨èï¼Œæœ€ç®€å•ï¼‰

**å‰æï¼šæœåŠ¡å™¨å·²å®‰è£… Docker**

```bash
# 1. å¯¼å…¥é¢„æ„å»ºçš„ Docker é•œåƒï¼ˆçº¦ 1 åˆ†é’Ÿï¼‰
docker load -i document-workspace-1.6.5.tar

# 2. å¯åŠ¨æœåŠ¡
docker-compose up -d

# 3. æŸ¥çœ‹çŠ¶æ€
docker-compose ps
```

**å¯åŠ¨æˆåŠŸåæ˜¾ç¤ºï¼š**
```
NAME                 STATUS    PORTS
document-workspace   Up        0.0.0.0:4300->4300/tcp
```

#### ğŸ“¦ æ–¹å¼äºŒï¼šNode.js ç›´æ¥è¿è¡Œ

**å‰æï¼šæœåŠ¡å™¨å·²å®‰è£… Node.js 18+**

```bash
# 1. å®‰è£…ä¾èµ–
npm install --production

# 2. å¯åŠ¨æœåŠ¡
npm run server
```

**å¯åŠ¨æˆåŠŸåæ˜¾ç¤ºï¼š**
```
Server running on http://0.0.0.0:4300
[INFO] Serving dist from ./dist
```

---

### ç¬¬4æ­¥ï¼šè®¿é—®åº”ç”¨

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š
```
http://ä½ çš„æœåŠ¡å™¨IP:4300
```

ä¾‹å¦‚ï¼š`http://192.168.1.100:4300`

**æŸ¥çœ‹æœåŠ¡å™¨ IPï¼š**
```bash
hostname -I
```

---

## ğŸ¯ åŠŸèƒ½å…¥å£

| é¡µé¢ | è®¿é—®æ–¹å¼ |
|------|----------|
| **å¤šæ–‡æ¡£å¤„ç†å·¥ä½œå°**ï¼ˆåº”ç”¨ç«¯ï¼‰ | ç›´æ¥è®¿é—® `http://IP:4300`ï¼ˆé»˜è®¤é¦–é¡µï¼‰ |
| **ç»éªŒæ²‰æ·€å·¥ä½œå°**ï¼ˆåç®¡ç«¯ï¼‰ | ç‚¹å‡»å³ä¸Šè§’ã€Œåˆ‡æ¢åå°ç®¡ç†å·¥ä½œå°ã€æŒ‰é’® |

---

## ğŸ”§ Docker å®‰è£…æŒ‡å—ï¼ˆå¦‚æœªå®‰è£…ï¼‰

### CentOS 7/8
```bash
# å®‰è£…ä¾èµ–
sudo yum install -y yum-utils

# æ·»åŠ  Docker æº
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

# å®‰è£… Docker
sudo yum install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin

# å¯åŠ¨ Docker
sudo systemctl start docker
sudo systemctl enable docker

# éªŒè¯å®‰è£…
docker --version
```

### Ubuntu 20.04/22.04
```bash
# æ›´æ–°åŒ…åˆ—è¡¨
sudo apt update

# å®‰è£… Docker
sudo apt install -y docker.io docker-compose

# å¯åŠ¨ Docker
sudo systemctl start docker
sudo systemctl enable docker

# éªŒè¯å®‰è£…
docker --version
```

---

## ğŸ”¥ å¸¸è§é—®é¢˜

### Q1: ç«¯å£ 4300 æ— æ³•è®¿é—®

```bash
# CentOS å¼€æ”¾ç«¯å£
sudo firewall-cmd --add-port=4300/tcp --permanent
sudo firewall-cmd --reload

# Ubuntu å¼€æ”¾ç«¯å£
sudo ufw allow 4300
```

### Q2: Docker æƒé™ä¸è¶³

```bash
# æ–¹æ³•1ï¼šä½¿ç”¨ sudo
sudo docker-compose up -d

# æ–¹æ³•2ï¼šå°†ç”¨æˆ·åŠ å…¥ docker ç»„ï¼ˆéœ€é‡æ–°ç™»å½•ï¼‰
sudo usermod -aG docker $USER
```

### Q3: åå°è¿è¡ŒæœåŠ¡ï¼ˆNode.js æ–¹å¼ï¼‰

```bash
# åå°å¯åŠ¨
nohup npm run server > app.log 2>&1 &

# æŸ¥çœ‹æ—¥å¿—
tail -f app.log

# åœæ­¢æœåŠ¡
pkill -f "node server.js"
```

### Q4: å¼€æœºè‡ªåŠ¨å¯åŠ¨

**Docker æ–¹å¼ï¼š** å·²è‡ªåŠ¨é…ç½®ï¼ˆ`restart: unless-stopped`ï¼‰

**Node.js æ–¹å¼ï¼š** åˆ›å»º systemd æœåŠ¡
```bash
sudo nano /etc/systemd/system/document-workspace.service
```

ç²˜è´´å†…å®¹ï¼ˆä¿®æ”¹è·¯å¾„ï¼‰ï¼š
```ini
[Unit]
Description=Document Workspace
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/home/ç”¨æˆ·å/document-workspace-1.6.5-offline
ExecStart=/usr/bin/node server.js
Restart=on-failure

[Install]
WantedBy=multi-user.target
```

å¯ç”¨æœåŠ¡ï¼š
```bash
sudo systemctl daemon-reload
sudo systemctl enable document-workspace
sudo systemctl start document-workspace
```

---

## ğŸ“‹ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨

### Docker æ–¹å¼

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| å¯åŠ¨æœåŠ¡ | `docker-compose up -d` |
| åœæ­¢æœåŠ¡ | `docker-compose down` |
| é‡å¯æœåŠ¡ | `docker-compose restart` |
| æŸ¥çœ‹çŠ¶æ€ | `docker-compose ps` |
| æŸ¥çœ‹æ—¥å¿— | `docker-compose logs -f` |
| è¿›å…¥å®¹å™¨ | `docker exec -it document-workspace sh` |

### Node.js æ–¹å¼

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| å¯åŠ¨æœåŠ¡ | `npm run server` |
| åå°å¯åŠ¨ | `nohup npm run server > app.log 2>&1 &` |
| æŸ¥çœ‹æ—¥å¿— | `tail -f app.log` |
| åœæ­¢æœåŠ¡ | `pkill -f "node server.js"` |

### é€šç”¨å‘½ä»¤

| æ“ä½œ | å‘½ä»¤ |
|------|------|
| æŸ¥çœ‹æœåŠ¡å™¨ IP | `hostname -I` |
| æ£€æŸ¥ç«¯å£å ç”¨ | `netstat -tlnp \| grep 4300` |
| æ£€æŸ¥é˜²ç«å¢™ | `sudo firewall-cmd --list-ports` |

---

## âœ… éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] æ–‡ä»¶å·²ä¼ è¾“åˆ° Linux æœåŠ¡å™¨
- [ ] å·²è§£å‹ zip æ–‡ä»¶
- [ ] Docker æˆ– Node.js å·²å®‰è£…
- [ ] æœåŠ¡å·²å¯åŠ¨
- [ ] æµè§ˆå™¨å¯è®¿é—® `http://IP:4300`
- [ ] **åº”ç”¨ç«¯**ï¼šçœ‹åˆ°ã€Œå¤šæ–‡æ¡£å¤„ç†å·¥ä½œå°ã€é¡µé¢
- [ ] **åç®¡ç«¯**ï¼šç‚¹å‡»åˆ‡æ¢æŒ‰é’®ï¼Œçœ‹åˆ°ã€Œç»éªŒæ²‰æ·€å·¥ä½œå°ã€é¡µé¢

---

## ğŸ“ æ•°æ®ç›®å½•è¯´æ˜

æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ `data/` ç›®å½•ï¼š

| æ–‡ä»¶ | å†…å®¹ |
|------|------|
| `docs.json` | ä¸Šä¼ çš„æ–‡æ¡£ |
| `precipitation-records.json` | æ²‰æ·€è®°å½• |
| `button-config.json` | æŒ‰é’®é…ç½® |
| `layout-config.json` | å¸ƒå±€é…ç½® |
| `outline-cache.json` | å¤§çº²ç¼“å­˜ |
| `scenes-cache.json` | åœºæ™¯ç¼“å­˜ |

**å¤‡ä»½æ•°æ®ï¼š**
```bash
tar -czvf data-backup-$(date +%Y%m%d).tar.gz data/
```

---

**ğŸ‰ æ­å–œï¼éƒ¨ç½²å®Œæˆï¼**

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒ `docs/OFFLINE_LINUX_DEPLOY.md` è·å–æ›´è¯¦ç»†çš„æŠ€æœ¯æ–‡æ¡£ã€‚
