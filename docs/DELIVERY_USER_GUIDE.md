# Agentic Workspace 交付使用手册

> 面向交付同学的功能使用指南

---

## 一、平台简介

### 这个平台是干什么的？

**一句话**：把你处理文档的操作"录"下来，下次遇到类似任务，系统自动帮你做。

**类比**：就像教一个新同事处理文档——你演示一遍，他记住步骤，以后类似任务他就会做了。

### 核心价值

| 以前 | 现在 |
|------|------|
| 每天重复同样的流程 | 录一次，以后一键执行 |
| 每个人处理方式不同 | 标准化流程，输出一致 |
| 老员工走了经验没了 | 经验沉淀在系统里 |
| 新人要培训1-2周 | 点按钮就能完成任务 |

---

## 二、两个工作台

平台有两个工作台，用途不同：

| 工作台 | 谁用 | 做什么 |
|--------|------|--------|
| **经验沉淀工作台** | 交付/配置人员（你） | 录制流程、配置按钮、调试沉淀 |
| **多文档处理工作台** | 最终用户 | 上传文档、点按钮、拿结果 |

**你的工作**：在"经验沉淀工作台"把流程配好，最终用户在"多文档处理工作台"点按钮就行。

---

## 三、核心概念

### 3.1 什么是"沉淀"？

**沉淀** = 把一次操作记录下来

你在平台上做的每一个操作（比如"从文档A提取数据填到大纲B"），系统都会记录成一个**沉淀步骤**。

### 3.2 沉淀的三个层级

```
沉淀步骤（Section）    ← 最小单位，一次按钮点击
      ↓
沉淀（Deposit）        ← 多个步骤组成一次录制
      ↓
沉淀集（Deposit Group） ← 多个沉淀组合成完整流程
```

**举例**：
- **沉淀步骤**："从日报.txt提取今日重点"
- **沉淀**："日报信息提取"（包含3个步骤）
- **沉淀集**："日报汇总流程"（包含：信息提取 + 格式整理 + 摘要生成）

### 3.3 什么是"Replay"？

**Replay** = 按照沉淀记录，在新文档上自动执行一遍

- 沉淀 = 录像
- Replay = 回放

但这个"回放"不是机械复现，而是**智能回放**——即使新文档的名称、结构有变化，系统也能通过语义理解找到正确位置。

---

## 四、沉淀步骤详解

### 每个沉淀步骤记录什么？

| 维度 | 说明 | 举例 |
|------|------|------|
| **输入来源** | 从哪里取数据 | "从日报.txt的第二段取256字" |
| **执行动作** | 做什么处理 | "提取关键信息，去除冗余" |
| **输出位置** | 结果写到哪 | "填入'工作汇总'标题的摘要" |
| **上下文特征** | 定位依据 | "前后文关键词、标题特征" |
| **计算公式** | 数值计算逻辑 | "字段A + 字段B = 总计" |
| **AI执行指导** | 详细的执行规则 | "定位条件、提取规则" |

### 双记录机制

每个沉淀步骤会**同时生成两套记录**：

| 记录类型 | 特点 | 用途 |
|----------|------|------|
| **大模型记录** | 描述意图，支持泛化 | 新文档结构变了也能适应 |
| **脚本记录** | 精确参数，100%准确 | 文档格式固定时保证准确 |

**执行逻辑**：
1. 优先用大模型记录（智能适应）
2. 失败自动切脚本记录（稳定兜底）
3. 用户不用选，系统自动切换

---

## 五、操作流程

### 5.1 录制沉淀（配置人员操作）

```
步骤1：上传示例文档
       ↓
步骤2：执行一遍完整操作
       • 抽取大纲
       • 填入摘要
       • 执行指令
       ↓
步骤3：系统自动记录每个操作为沉淀步骤
       ↓
步骤4：检查/编辑沉淀记录
       • 调整步骤顺序
       • 修改错误的步骤
       • 删除多余的步骤
       ↓
步骤5：组合成沉淀集
       ↓
步骤6：关联到应用按钮
```

### 5.2 执行Replay（配置人员测试/最终用户使用）

```
步骤1：上传新文档
       ↓
步骤2：点击已配置的按钮
       ↓
步骤3：系统自动执行
       • 加载关联的沉淀集
       • 按顺序执行每个步骤
       • 语义匹配定位新文档位置
       • 优先大模型，失败降级脚本
       ↓
步骤4：查看执行结果
       • 检查每步状态（pass/fail/skipped）
       • 查看最终输出
```

---

## 六、沉淀管理

### 6.1 沉淀列表

在"经验沉淀工作台"可以看到所有已录制的沉淀：

- **查看**：点击沉淀查看包含的步骤
- **编辑**：修改步骤内容、调整顺序
- **删除**：删除不需要的沉淀
- **复制**：复制一份进行修改

### 6.2 沉淀步骤编辑

每个步骤可以：

| 操作 | 说明 |
|------|------|
| **编辑内容** | 修改操作描述、目标位置等 |
| **调整顺序** | 拖拽改变执行顺序 |
| **单步测试** | 只执行这一步看效果 |
| **删除步骤** | 移除错误的步骤 |
| **插入步骤** | 在中间添加新步骤 |

### 6.3 沉淀集管理

沉淀集是多个沉淀的组合：

```
沉淀集：日报汇总流程
├── 沉淀1：信息提取
│   ├── 步骤1.1：提取日期
│   ├── 步骤1.2：提取数据
│   └── 步骤1.3：提取结论
├── 沉淀2：格式整理
│   ├── 步骤2.1：统一格式
│   └── 步骤2.2：去重合并
└── 沉淀3：摘要生成
    └── 步骤3.1：生成汇总
```

**操作**：
- **添加沉淀**：把已有沉淀加入沉淀集
- **调整顺序**：改变沉淀的执行顺序
- **移除沉淀**：从沉淀集中移除

---

## 七、按钮配置

### 7.1 什么是应用按钮？

应用按钮是给最终用户用的"一键执行"入口。

配置人员把沉淀集关联到按钮，用户点按钮就自动执行整个流程。

### 7.2 按钮配置流程

```
步骤1：进入"按钮配置"面板
       ↓
步骤2：创建或选择按钮
       • 设置按钮名称（如"日报合并"）
       ↓
步骤3：关联沉淀集
       • 选择要执行的沉淀集
       • 可以关联多个沉淀集
       ↓
步骤4：设置执行顺序
       • 多个沉淀集按顺序执行
       ↓
步骤5：测试按钮
       • 用测试文档验证效果
       ↓
步骤6：发布给用户使用
```

### 7.3 按钮执行逻辑

```
用户点击按钮
     ↓
加载关联的沉淀集（可能多个）
     ↓
按顺序执行每个沉淀集
     ↓
每个沉淀集内按顺序执行步骤
     ↓
每个步骤：大模型优先 → 脚本兜底
     ↓
输出执行结果
```

---

## 八、执行状态说明

### 8.1 步骤执行状态

| 状态 | 含义 | 说明 |
|------|------|------|
| **pass** | 执行成功 | 操作完成，结果符合预期 |
| **fail** | 执行失败 | 大模型和脚本都失败了 |
| **skipped** | 跳过执行 | 前置条件不满足，跳过这步 |

### 8.2 验证模式

| 模式 | 说明 |
|------|------|
| **强验证** | 结果与预期不符就标记失败 |
| **无验证** | 直接执行，不校验结果 |

### 8.3 执行引擎机制

| 机制 | 说明 |
|------|------|
| **自动重试** | 失败时自动重试（可配置次数） |
| **智能降级** | 大模型失败自动切脚本 |
| **状态追踪** | 每步都有执行状态记录 |
| **快照回滚** | 出问题可以恢复 |

---

## 九、常见问题

### Q1: 录制的沉淀在新文档上执行失败？

**可能原因**：
1. 新文档结构差异太大
2. 目标位置找不到

**解决方法**：
1. 检查沉淀记录的"上下文特征"是否准确
2. 编辑沉淀步骤，增加更多定位信息
3. 对于差异大的文档，考虑单独录制

### Q2: 大模型执行很慢？

**原因**：大模型需要理解语义，比脚本慢

**解决方法**：
1. 对于格式固定的操作，优化脚本记录
2. 检查网络连接
3. 考虑批量执行而非单步执行

### Q3: 脚本执行失败？

**原因**：脚本依赖精确匹配，文档有变化就会失败

**解决方法**：
1. 确保文档格式和录制时一致
2. 依赖大模型记录做智能匹配

### Q4: 如何让沉淀更"泛化"？

**技巧**：
1. 录制时用有代表性的文档
2. 操作描述写清楚"意图"而非"位置"
3. 多用语义特征（标题含义）而非精确位置（第几行）

### Q5: 按钮点了没反应？

**检查**：
1. 按钮是否关联了沉淀集？
2. 是否上传了文档？
3. 查看控制台是否有错误日志

---

## 十、最佳实践

### 10.1 录制沉淀的建议

1. **用典型文档录制**：选择最常见格式的文档作为示例
2. **步骤拆细**：复杂操作拆成多个小步骤，便于调试
3. **写好描述**：每个步骤的描述要清晰，方便后续维护
4. **及时测试**：录完一个步骤就测试，发现问题早改

### 10.2 组织沉淀集的建议

1. **按功能分组**：一个沉淀集对应一个完整功能
2. **可复用设计**：通用的沉淀可以被多个沉淀集引用
3. **命名规范**：用清晰的名称，如"日报-数据提取"而非"沉淀1"

### 10.3 配置按钮的建议

1. **名称直观**：用户看按钮名就知道做什么
2. **先测试再发布**：用多种文档测试确保稳定
3. **提供说明**：告诉用户这个按钮需要什么格式的文档

---

## 十一、界面操作指南

### 经验沉淀工作台布局

```
┌──────────────────────────────────────────────────────────┐
│                        顶部工具栏                         │
│  [上传文档] [抽取大纲] [保存] [设置]                      │
├────────────┬─────────────────────────┬───────────────────┤
│            │                         │                   │
│  文档列表   │        大纲编辑区        │    沉淀管理面板   │
│            │                         │                   │
│  • 日报.txt │  一、标题1              │  已录制沉淀：     │
│  • 周报.txt │    [摘要输入框]         │  • 数据提取       │
│            │  二、标题2              │  • 格式整理       │
│            │    [摘要输入框]         │  • 摘要生成       │
│            │                         │                   │
├────────────┴─────────────────────────┴───────────────────┤
│                      操作日志/调试信息                     │
└──────────────────────────────────────────────────────────┘
```

### 多文档处理工作台布局

```
┌──────────────────────────────────────────────────────────┐
│                        顶部操作区                         │
│  [上传文档]  [日报合并] [竞品分析] [自定义]               │
├────────────┬─────────────────────────┬───────────────────┤
│            │                         │                   │
│  来源文档   │        处理结果         │    输出预览       │
│            │                         │                   │
│  已上传：   │  执行进度：80%          │  生成的内容...    │
│  • 文档1    │  步骤1: pass ✓          │                   │
│  • 文档2    │  步骤2: pass ✓          │                   │
│  • 文档3    │  步骤3: 执行中...       │                   │
│            │                         │                   │
└────────────┴─────────────────────────┴───────────────────┘
```

---

## 十二、1.6.6 版本更新

### 应用端执行改进

#### 统一执行逻辑
- 所有沉淀（包括"最终文档生成"）都通过相同的 API 执行
- 移除了所有定制化特殊处理，代码更简洁可靠

#### 耗时统计
- 执行完成后自动显示耗时
- 示例：`⏱️ 耗时统计：12.3 秒`

### 新增功能
| 功能 | 说明 |
|------|------|
| 执行耗时显示 | 从点击按钮到完成的总耗时 |
| 智能时间格式 | 毫秒/秒/分钟自动切换 |

### Bug 修复
- 修复应用端执行时的 404 错误
- API 路径更正，确保状态更新正常

---

*文档版本：1.6.6*
